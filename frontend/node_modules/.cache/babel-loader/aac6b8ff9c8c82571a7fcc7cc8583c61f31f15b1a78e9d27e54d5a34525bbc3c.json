{"ast":null,"code":"var _jsxFileName = \"/frontend/src/pages/JoinSession.tsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect } from \"react\";\nimport { Box, Typography, TextField, Button, Paper } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { useWebSocket } from \"../context/WebSocketContext\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst JoinSession = () => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const {\n    socket,\n    connect\n  } = useWebSocket();\n  const navigate = useNavigate();\n  const [documentId, setDocumentId] = useState(\"\");\n  const [isJoining, setIsJoining] = useState(false);\n  useEffect(() => {\n    if (!socket) return;\n    const handleParticipantUpdate = data => {\n      if (data.document_id === documentId) {\n        setIsJoining(false);\n        navigate(`/collaborate/${documentId}`);\n      }\n    };\n    const handleError = error => {\n      console.error(error.message);\n      alert(error.message);\n      setIsJoining(false);\n    };\n    socket.on(\"participant_update\", handleParticipantUpdate);\n    socket.on(\"error\", handleError);\n    return () => {\n      socket.off(\"participant_update\", handleParticipantUpdate);\n      socket.off(\"error\", handleError);\n    };\n  }, [socket, documentId, navigate]);\n  const handleJoinSession = async () => {\n    if (!documentId) {\n      alert(\"Document ID is required!\");\n      return;\n    }\n    if (!(user !== null && user !== void 0 && user.username)) {\n      alert(\"You must be logged in to join a session!\");\n      return;\n    }\n    setIsJoining(true);\n    try {\n      const connectedSocket = await connect(); // Wait for the socket to connect\n      connectedSocket.emit(\"join_session\", {\n        username: user.username,\n        document_id: documentId\n      }, response => {\n        if (response !== null && response !== void 0 && response.error) {\n          alert(response.error);\n          setIsJoining(false);\n        } else {\n          // Navigate to the collaboration page if successful\n          navigate(`/collaborate/${documentId}`);\n        }\n      });\n    } catch (error) {\n      console.error(\"Socket connection error\", error);\n      alert(\"Failed to connect to the server. Please try again.\");\n      setIsJoining(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    style: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      minHeight: \"100vh\"\n    },\n    children: [/*#__PURE__*/_jsxDEV(Box, {\n      style: {\n        textAlign: \"center\",\n        padding: \"20px\",\n        backgroundColor: \"#fff\",\n        borderBottom: \"1px solid #ccc\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Typography, {\n        variant: \"h5\",\n        style: {\n          fontWeight: \"bold\",\n          color: \"#333\"\n        },\n        children: [\"Join a Collaboration Session\", user !== null && user !== void 0 && user.username ? `, ${user.username}` : \"\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      alignItems: \"center\",\n      flexGrow: 1,\n      style: {\n        backgroundColor: \"#f4f4f4\",\n        borderRadius: \"8px\",\n        padding: \"20px\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Paper, {\n        elevation: 3,\n        style: {\n          padding: \"30px\",\n          textAlign: \"center\",\n          width: \"400px\",\n          backgroundColor: \"white\",\n          borderRadius: \"8px\"\n        },\n        children: [/*#__PURE__*/_jsxDEV(Typography, {\n          variant: \"h6\",\n          style: {\n            fontWeight: \"bold\",\n            marginBottom: \"20px\",\n            color: \"#555\"\n          },\n          children: \"Enter Session ID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(TextField, {\n          variant: \"outlined\",\n          fullWidth: true,\n          placeholder: \"Enter Document ID\",\n          value: documentId,\n          onChange: e => setDocumentId(e.target.value),\n          disabled: isJoining // Disable input during join\n          ,\n          style: {\n            marginBottom: \"20px\"\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 125,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Button, {\n          variant: \"contained\",\n          color: \"primary\",\n          fullWidth: true,\n          style: {\n            fontWeight: \"bold\",\n            fontSize: \"16px\",\n            padding: \"10px\"\n          },\n          onClick: handleJoinSession,\n          disabled: isJoining,\n          children: isJoining ? \"Joining...\" : \"Join Session\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 134,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 105,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 98,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Box, {\n      display: \"flex\",\n      justifyContent: \"center\",\n      style: {\n        padding: \"20px\",\n        backgroundColor: \"#fff\",\n        borderTop: \"1px solid #ccc\"\n      },\n      children: /*#__PURE__*/_jsxDEV(Button, {\n        variant: \"text\",\n        color: \"secondary\",\n        style: {\n          fontWeight: \"bold\",\n          fontSize: \"14px\"\n        },\n        onClick: () => navigate(\"/dashboard\"),\n        children: \"Back to Dashboard\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 9\n  }, this);\n};\n_s(JoinSession, \"SJBgOZMeSbaTfQrY4SxOZWFoYwo=\", false, function () {\n  return [useAuth, useWebSocket, useNavigate];\n});\n_c = JoinSession;\nexport default JoinSession;\nvar _c;\n$RefreshReg$(_c, \"JoinSession\");","map":{"version":3,"names":["React","useState","useEffect","Box","Typography","TextField","Button","Paper","useNavigate","useAuth","useWebSocket","jsxDEV","_jsxDEV","JoinSession","_s","user","socket","connect","navigate","documentId","setDocumentId","isJoining","setIsJoining","handleParticipantUpdate","data","document_id","handleError","error","console","message","alert","on","off","handleJoinSession","username","connectedSocket","emit","response","style","display","flexDirection","minHeight","children","textAlign","padding","backgroundColor","borderBottom","variant","fontWeight","color","fileName","_jsxFileName","lineNumber","columnNumber","justifyContent","alignItems","flexGrow","borderRadius","elevation","width","marginBottom","fullWidth","placeholder","value","onChange","e","target","disabled","fontSize","onClick","borderTop","_c","$RefreshReg$"],"sources":["/frontend/src/pages/JoinSession.tsx"],"sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { Box, Typography, TextField, Button, Paper } from \"@mui/material\";\nimport { useNavigate } from \"react-router-dom\";\nimport { useAuth } from \"../context/AuthContext\";\nimport { useWebSocket } from \"../context/WebSocketContext\";\n\nconst JoinSession: React.FC = () => {\n    const { user } = useAuth();\n    const { socket, connect } = useWebSocket();\n    const navigate = useNavigate();\n\n    const [documentId, setDocumentId] = useState<string>(\"\");\n    const [isJoining, setIsJoining] = useState(false);\n\n    useEffect(() => {\n        if (!socket) return;\n\n        const handleParticipantUpdate = (data: { document_id: string }) => {\n            if (data.document_id === documentId) {\n                setIsJoining(false);\n                navigate(`/collaborate/${documentId}`);\n            }\n        };\n\n        const handleError = (error: { message: string }) => {\n            console.error(error.message);\n            alert(error.message);\n            setIsJoining(false);\n        };\n\n        socket.on(\"participant_update\", handleParticipantUpdate);\n        socket.on(\"error\", handleError);\n\n        return () => {\n            socket.off(\"participant_update\", handleParticipantUpdate);\n            socket.off(\"error\", handleError);\n        };\n    }, [socket, documentId, navigate]);\n\n    const handleJoinSession = async () => {\n        if (!documentId) {\n            alert(\"Document ID is required!\");\n            return;\n        }\n    \n        if (!user?.username) {\n            alert(\"You must be logged in to join a session!\");\n            return;\n        }\n    \n        setIsJoining(true);\n    \n        try {\n            const connectedSocket = await connect(); // Wait for the socket to connect\n            connectedSocket.emit(\n                \"join_session\",\n                { username: user.username, document_id: documentId },\n                (response: { error?: string }) => {\n                    if (response?.error) {\n                        alert(response.error);\n                        setIsJoining(false);\n                    } else {\n                        // Navigate to the collaboration page if successful\n                        navigate(`/collaborate/${documentId}`);\n                    }\n                }\n            );\n        } catch (error) {\n            console.error(\"Socket connection error\", error);\n            alert(\"Failed to connect to the server. Please try again.\");\n            setIsJoining(false);\n        }\n    };\n\n    return (\n        <div style={{ display: \"flex\", flexDirection: \"column\", minHeight: \"100vh\" }}>\n            {/* Header */}\n            <Box\n                style={{\n                    textAlign: \"center\",\n                    padding: \"20px\",\n                    backgroundColor: \"#fff\",\n                    borderBottom: \"1px solid #ccc\",\n                }}\n            >\n                <Typography\n                    variant=\"h5\"\n                    style={{\n                        fontWeight: \"bold\",\n                        color: \"#333\",\n                    }}\n                >\n                    Join a Collaboration Session{user?.username ? `, ${user.username}` : \"\"}\n                </Typography>\n            </Box>\n\n            {/* Content */}\n            <Box\n                display=\"flex\"\n                justifyContent=\"center\"\n                alignItems=\"center\"\n                flexGrow={1}\n                style={{ backgroundColor: \"#f4f4f4\", borderRadius: \"8px\", padding: \"20px\" }}\n            >\n                <Paper\n                    elevation={3}\n                    style={{\n                        padding: \"30px\",\n                        textAlign: \"center\",\n                        width: \"400px\",\n                        backgroundColor: \"white\",\n                        borderRadius: \"8px\",\n                    }}\n                >\n                    <Typography\n                        variant=\"h6\"\n                        style={{\n                            fontWeight: \"bold\",\n                            marginBottom: \"20px\",\n                            color: \"#555\",\n                        }}\n                    >\n                        Enter Session ID\n                    </Typography>\n                    <TextField\n                        variant=\"outlined\"\n                        fullWidth\n                        placeholder=\"Enter Document ID\"\n                        value={documentId}\n                        onChange={(e) => setDocumentId(e.target.value)}\n                        disabled={isJoining} // Disable input during join\n                        style={{ marginBottom: \"20px\" }}\n                    />\n                    <Button\n                        variant=\"contained\"\n                        color=\"primary\"\n                        fullWidth\n                        style={{\n                            fontWeight: \"bold\",\n                            fontSize: \"16px\",\n                            padding: \"10px\",\n                        }}\n                        onClick={handleJoinSession}\n                        disabled={isJoining}\n                    >\n                        {isJoining ? \"Joining...\" : \"Join Session\"}\n                    </Button>\n                </Paper>\n            </Box>\n\n            {/* Logout Button */}\n            <Box\n                display=\"flex\"\n                justifyContent=\"center\"\n                style={{ padding: \"20px\", backgroundColor: \"#fff\", borderTop: \"1px solid #ccc\" }}\n            >\n                <Button\n                    variant=\"text\"\n                    color=\"secondary\"\n                    style={{\n                        fontWeight: \"bold\",\n                        fontSize: \"14px\",\n                    }}\n                    onClick={() => navigate(\"/dashboard\")}\n                >\n                    Back to Dashboard\n                </Button>\n            </Box>\n        </div>\n    );\n};\n\nexport default JoinSession;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}